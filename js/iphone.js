
const productData = {
    "iphone17-promax": {
        "name": "iPhone 17 ProMax",
        "storageOptions": [
            {
                "name": "256GB",
                "price": "37.799.000đ",
                "oldPrice": "40.999.000đ"
            },
            {
                "name": "512GB",
                "price": "44.499.000đ",
                "oldPrice": "47.999.000đ"
            },
            {
                "name": "1TB",
                "price": "50.799.000đ",
                "oldPrice": "56.999.000đ"
            },
            {
                "name": "2TB",
                "price": "63.799.000đ",
                "oldPrice": "56.999.000đ"
            }
        ],
        "colorOptions": [
            {
                "name": "Cam Vũ Trụ",
                "colorCode": "#f77644ff",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/iphone-17-pro-max_cam.png"
            },
            {
                "name": "Đen",
                "colorCode": "#3b3b3c",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/iphone-17-pro-max-tim.png"
            },
            {
                "name": "Trắng",
                "colorCode": "#f0f0f0",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/iphone-17-pro-max-white.png"
            }
        ]
    },
    "iphone17-pro": {
        "name": "iPhone 17 Pro",
        "storageOptions": [
            {
                "name": "256GB",
                "price": "34.799.000đ",
                "oldPrice": "37.999.000đ"
            },
            {
                "name": "512GB",
                "price": "41.299.000đ",
                "oldPrice": "45.799.000đ"
            },
            {
                "name": "1TB",
                "price": "47.799.000đ",
                "oldPrice": "50.999.000đ"
            }
        ],
        "colorOptions": [
            {
                "name": "Cam Vũ Trụ",
                "colorCode": "#f77644ff",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/iphone-17-pro-max_cam.png"
            },
            {
                "name": "Đen",
                "colorCode": "#3b3b3c",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/iphone-17-pro-max-tim.png"
            },
            {
                "name": "Trắng",
                "colorCode": "#f0f0f0",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/iphone-17-pro-max-white.png"
            }
        ]
    },
    "iphone17": {
        "name": "iPhone 17",
        "storageOptions": [
            {
                "name": "256GB",
                "price": "24.799.000đ",
                "oldPrice": "27.999.000đ"
            },
            {
                "name": "512GB",
                "price": "31.299.000đ",
                "oldPrice": "36.799.000đ"
            }
        ],
        "colorOptions": [
            {
                "name": "Tím oải hương",
                "colorCode": "#E9DAF1",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/ip17-lavender.png"
            },
            {
                "name": "Xám",
                "colorCode": "#3b3b3c",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/ip17-xam.png"
            },
            {
                "name": "Trắng",
                "colorCode": "#f0f0f0",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/ip17-trang.png"
            },
            {
                "name": "Xanh Bạc Hà",
                "colorCode": "#B9C69B",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/ip17-mint.png"
            }, {
                "name": "Xanh Bồng Bềnh",
                "colorCode": "#A7BDDD",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/ip17-sage.png"
            }
        ]
    },
    "iphone-air": {
        "name": "iPhone Air",
        "storageOptions": [
            {
                "name": "256GB",
                "price": "24.799.000đ",
                "oldPrice": "27.999.000đ"
            },
            {
                "name": "512GB",
                "price": "31.299.000đ",
                "oldPrice": "36.799.000đ"
            }
        ],
        "colorOptions": [

            {
                "name": "Đen",
                "colorCode": "black",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/iphone-air-black.png"
            },
            {
                "name": "Vàng ánh kim",
                "colorCode": "#FFFFCC",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/iphone-air-golden.png"
            },
            {
                "name": "Xanh Bồng Bềnh",
                "colorCode": "#A7BDDD",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/iphone-air-sage.png"
            }
        ]
    },
    "iphone16-promax": {
        "name": "iPhone 16 ProMax",
        "storageOptions": [
            {
                "name": "256GB",
                "price": "24.799.000đ",
                "oldPrice": "27.999.000đ"
            },
            {
                "name": "512GB",
                "price": "31.299.000đ",
                "oldPrice": "36.799.000đ"
            },
            {
                "name": "512GB",
                "price": "31.299.000đ",
                "oldPrice": "36.799.000đ"
            }
        ],
        "colorOptions": [
            {
                "name": "Titan sa mạc",
                "colorCode": "#FFFFCC",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/iphone-16-prm-titansamac.png"
            },
            {
                "name": "Đen",
                "colorCode": "black",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/iphone-16-prm-black.png"
            },
            {
                "name": "Xanh Bồng Bềnh",
                "colorCode": "#A7BDDD",
                "image": "../assets/images/NguyenDucVu_241230896/product_image/iPhone_image/iphone-air-sage.png"
            }
        ]
    }
};

/**
 * Hàm tạo HTML cho một sản phẩm, đã được cập nhật để bao gồm thẻ <div class="item-box">.
 * @param {string} productKey - Key của sản phẩm trong productData (ví dụ: 'iphone17-promax').
 * @param {object} product - Đối tượng dữ liệu sản phẩm.
 * @returns {string} HTML string cho sản phẩm.
 */
function createProductHtml(productKey, product) {
    const firstStorage = product.storageOptions[0];
    const firstColor = product.colorOptions[0];

    // Định dạng URL chi tiết sản phẩm theo yêu cầu
    const detailUrl = `product.html?id=${productKey}`; 

    const productName = `${product.name}`;
    const price = firstStorage ? firstStorage.price : 'Đang cập nhật';
    const oldPrice = firstStorage ? firstStorage.oldPrice : '';
    const imageSrc = firstColor ? firstColor.image : '';
    const imageAlt = firstColor ? `${product.name} ${firstColor.name}` : productName;

    return `<div class="product-box">
            <div class="product-tag">
                <img src="../assets/images/NguyenDucVu_241230896/product_image/Product_tag/new_tag.png" alt="" />
            </div>
            <a href="${detailUrl}" class="product-detail-url">
                <div class="item-box"> <div class="product-image">
                        <img src="${imageSrc}" alt="${imageAlt}" class="product-img">
                    </div>
                    <h3 class="product-name">${productName}</h3>
                    <div class="price-section">
                        <span class="curr_price">${price}</span>
                        <span class="old-price">${oldPrice}</span>
                    </div>
                </div> </a>
            </div>
    `;
}

/**
 * Hàm chính để load tất cả sản phẩm vào DOM.
 */
function loadProducts() {
    // Lấy container cha để chứa tất cả sản phẩm
    const productContainer = document.querySelector('.products-container');
    
    if (!productContainer) {
        console.error("Không tìm thấy div.page-content để chèn sản phẩm.");
        return;
    }

    let allProductsHtml = '';
    // Lặp qua từng sản phẩm trong dữ liệu
    for (const key in productData) {
        if (productData.hasOwnProperty(key)) {
            const product = productData[key];
            allProductsHtml += createProductHtml(key, product);
        }
    }

    // Chèn tất cả HTML sản phẩm vào container
    productContainer.innerHTML = allProductsHtml;
}

// Chờ DOM load xong rồi thực thi hàm loadProducts
document.addEventListener('DOMContentLoaded', loadProducts);